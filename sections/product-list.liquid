{{- 'product-list.css' | asset_url | stylesheet_tag -}}

{%- liquid
  assign section_heading = section.settings.heading
  assign marker_style = section.settings.marker_style
  assign margin_bottom_desktop = section.settings.margin_bottom_desktop | default: 30
  assign margin_bottom_mobile = section.settings.margin_bottom_mobile | default: 20
-%}
<div class="row">
  <div class="small-12 product-list" style="--margin-bottom-desktop: {{ margin_bottom_desktop }}px; --margin-bottom-mobile: {{ margin_bottom_mobile }}px;">

    {% render 'section-header'
      , section_heading: section_heading
      , marker_style: marker_style %}

    <slide-show class="scrolling-products products" id="product-list-{{ section.id }}">
      <div class="flickity-nav flickity-prev" tabindex="0">{% render 'svg-icons' with 'carousel-prev' %}</div>
      <div class="flickity-nav flickity-next" tabindex="0">{% render 'svg-icons' with 'carousel-next' %}</div>
      <div class="scrolling-products--inner">
        <div class="scrolling-products--wrapper">
          {%- for block in section.blocks -%}
            <div class="scrolling-products--item carousel__slide" {{ block.shopify_attributes }}>
              {%- if block.settings.image -%}
                <div class="product-image aspect-ratio aspect-ratio--square">
                  {%- render 'responsive-image'
                    , image: block.settings.image
                    , sizes: '300x300'
                    , retina: 1 -%}
                </div>
              {%- else -%}
                <div class="product-image aspect-ratio aspect-ratio--square thb-placeholder">
                  {{ 'product-1' | placeholder_svg_tag }}
                </div>
              {%- endif -%}
              <div class="product-details">
                {%- if block.settings.title -%}
                  <div class="product-title">{{ block.settings.title }}</div>
                {%- endif -%}
                {%- if block.settings.quantity -%}
                  <div class="product-quantity">x {{ block.settings.quantity }}</div>
                {%- endif -%}
              </div>
            </div>
          {%- endfor -%}
        </div>
      </div>
    </slide-show>
  </div>
</div>

{% schema %}
  {
    "name": "产品列表",
    "class": "section-product-list",
    "settings": [
      {
        "type": "text",
        "id": "heading",
        "label": "标题",
        "default": "产品列表"
      }, {
      "type": "select",
      "id": "marker_style",
      "options": [
        {
          "value": "style1",
          "label": "Basic"
        }, {
          "value": "style2",
          "label": "Double"
        }, {
          "value": "style3",
          "label": "Squiggle"
        }, {
          "value": "style4",
          "label": "Zigzag"
        }
      ],
      "default": "style1",
      "label": "Marker"
    }, {
      "type": "range",
      "id": "margin_bottom_desktop",
      "min": 0,
      "max": 50,
      "step": 5,
      "default": 30,
      "label": "桌面端下边距 (px)"
    }, {
      "type": "range",
      "id": "margin_bottom_mobile",
      "min": 0,
      "max": 50,
      "step": 5,
      "default": 20,
      "label": "移动端下边距 (px)"
    }
    ],
    "blocks": [
      {
        "type": "product_item",
        "name": "产品项",
        "settings": [
          {
            "type": "image_picker",
            "id": "image",
            "label": "图片"
          }, {
            "type": "text",
            "id": "title",
            "label": "标题"
          }, {
            "type": "number",
            "id": "quantity",
            "label": "数量",
            "default": 1
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "产品列表",
        "blocks": [
          {
            "type": "product_item"
          }, {
            "type": "product_item"
          }, {
            "type": "product_item"
          }, {
            "type": "product_item"
          }
        ]
      }
    ]
  }
{% endschema %}